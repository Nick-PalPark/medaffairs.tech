<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>MedAffairs.tech</title>
    <link rel="stylesheet" href="style.css" />
</head>
<body>
    <section class="hero-lockup">
        <a class="hero-item" href="#">
            <img class="hero-img" src="" alt="">
            <div class="headline"></div>
        </a>
        <a class="hero-item" href="#">
            <img class="hero-img" src="" alt="">
            <div class="headline"></div>
        </a>
        <a class="hero-item" href="#">
            <img class="hero-img" src="" alt="">
            <div class="headline"></div>
        </a>
    </section>

    <header class="site-header">
        <h1 class="main-title">MEDAFFAIRS.TECH</h1>
        <div class="last-updated" id="lastUpdated" style="display:none;"></div>
    </header>

    <main>
        <section class="columns">
            <div class="column industry">
                <div class="column-icon">üè¢</div>
                <h2>Industry News</h2>
                <ul></ul>
            </div>
            <div class="column tech">
                <div class="column-icon">üíª</div>
                <h2>Tech Insights</h2>
                <ul></ul>
            </div>
            <div class="column opinion">
                <div class="column-icon">üí¨</div>
                <h2>Products & Opinion</h2>
                <ul></ul>
            </div>
        </section>
    </main>

    <script>
    async function loadArticles() {
        try {
            const response = await fetch('./articles.json?cb=' + Date.now());
            if (!response.ok) throw new Error('Could not load articles.json');

            const data = await response.json();

            // Last updated
            if (data.last_updated) {
                const lastUpdatedEl = document.getElementById('lastUpdated');
                lastUpdatedEl.textContent = 'Last updated: ' + new Date(data.last_updated).toLocaleString();
                lastUpdatedEl.style.display = 'block';
            }

            // Heroes
            const heroItems = document.querySelectorAll('.hero-item');
            (data.heroes || []).forEach((article, i) => {
                if (heroItems[i]) {
                    heroItems[i].href = article.url || "#";
                    heroItems[i].querySelector('.headline').textContent = article.title || "No title";
                    heroItems[i].querySelector('.hero-img').src = article.cover_image || "";
                    heroItems[i].querySelector('.hero-img').alt = article.title || "";
                    if (article.url && article.url.startsWith('http')) {
                        heroItems[i].target = '_blank';
                        heroItems[i].rel = 'noopener noreferrer';
                    }
                }
            });

            // Industry
            const industryList = document.querySelector('.industry ul');
            industryList.innerHTML = (data.industry || []).map(article =>
                `<li><a href="${article.url}" target="_blank" rel="noopener noreferrer">${article.title}</a></li>`
            ).join('');

            // Tech
            const techList = document.querySelector('.tech ul');
            techList.innerHTML = (data.tech || []).map(article =>
                `<li><a href="${article.url}" target="_blank" rel="noopener noreferrer">${article.title}</a></li>`
            ).join('');

            // Opinion
            const opinionList = document.querySelector('.opinion ul');
            opinionList.innerHTML = (data.opinion || []).map(article =>
                `<li><a href="${article.url}" target="_blank" rel="noopener noreferrer">${article.title}</a></li>`
            ).join('');

        } catch (err) {
            document.querySelectorAll('.headline').forEach(el => el.textContent = "Error loading news");
            document.querySelector('.industry ul').innerHTML = "<li>Error loading industry news</li>";
            document.querySelector('.tech ul').innerHTML = "<li>Error loading tech insights</li>";
            document.querySelector('.opinion ul').innerHTML = "<li>Error loading opinion articles</li>";
        }
    }

    document.addEventListener('DOMContentLoaded', loadArticles);
    </script>

    <footer>
        <p>&copy; 2025 MedAffairs.tech</p>
    </footer>
</body>
</html>
